These scripts are designed to perform daily spatiotemporal cluster detection on a selected list of reportable diseases. The script 'Running satscan.R' imports a line list of confirmed cases reported to CCDPH in the previous 365 days (see SatScan Data_template.csv for the expected data structure). The script then uses the [rsatscan package] (https://www.satscan.org/rsatscan/rsatscan.html) to call [SatScan] (https://www.satscan.org/) and perform a spacetime permutation scan analysis, using the latitude and longitude of each case. This project was modeled after New York City's Department of Health and Mental Hygiene (NYC DOHMH) daily spatiotemporal cluster detection program for reportable diseases using SAS and SatScan. Their methods - including analysis parameters - are documented [here] (https://wwwnc.cdc.gov/eid/article/22/10/16-0097_article) (SAS code available [here](https://github.com/CityOfNewYork/communicable-disease-surveillance-nycdohmh)). We recommend reading their publication and technical appendix in full before using this code and thank them for making their code publicly available.

After the SatScan analysis is performed, the most likely cluster detected each day (i.e. the cluster with the highest recurrence interval) is stored for historical purposes ('Cluster History File_template.csv').  If the most likely cluster (or any other cluster detected) has a recurrence interval greater than or equal to 100 days, a report describing the cluster is generated ('New Cluster Report.Rmd'). This report, which includes a cluster line list and map, is then automatically emailed to an epidemiologist for investigation. Cases that are part of these statistically significant clusters are saved in a separate history file ('Case History File_template.csv').  If a new cluster is later detected that contains a case listed in the Case History File (meaning it was part of a previously detected significant cluster), the original cluster is considered "ongoing" and all cases in the new cluster area are added to the original cluster. A new cluster report is generated ('Ongoing Cluster Report.Rmd') with an updated line list and map and emailed to the relevant epidemiologist. At the end of the script, a summary report of the day's analysis is emailed to the programmer for awareness.

Questions on these scripts should be directed to kbemis@cookcountyhhs.org.
